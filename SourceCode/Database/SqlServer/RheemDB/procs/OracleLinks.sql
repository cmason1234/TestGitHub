USE [rheemdb]

/* 
------------------------------------------------------------
   Description:  Common stored procedures For table 'OracleLink'
   
   AUTHOR:       Brian White - 8/23/2011 11:38:03 AM
   
   LEGAL :       Copyright 2011 - Rheem Manufacturing
   
   Generated by MyGeneration Version 1.3.0.9
------------------------------------------------------------ 
*/
   


If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('InsertOracleLink') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
	    DROP PROCEDURE InsertOracleLink;
		PRINT 'Dropped InsertOracleLink'
	END
GO

/* ------------------------------------------------------------
   PROCEDURE:    InsertOracleLink
   
   Description:  Inserts a record into table 'OracleLink'
   
   AUTHOR:       Rheem Manufacturing, Brian White - 8/23/2011 11:38:03 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.InsertOracleLink
(
	@OracleLinkID uniqueidentifier = null output,
	@OracleModuleID uniqueidentifier, 
	@URL varchar(150) = null, 
	@URLText varchar(150) = null, 
	@AltText varchar(500) = null, 
	@Active bit, 
	@AlertText varchar(500) = null, 
	@LinkOrder int
)

AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
	DECLARE @Err Int
	
	SET @OracleLinkID = NewID()
	

	INSERT
	INTO [OracleLink]
	(
		[OracleLinkID], 
		[OracleModuleID], 
		[URL], 
		[URLText], 
		[AltText], 
		[Active], 
		[AlertText], 
		[LinkOrder]
	)
	VALUES
	(
		@OracleLinkID, 
		@OracleModuleID, 
		@URL, 
		@URLText, 
		@AltText, 
		@Active, 
		@AlertText, 
		@LinkOrder

	)

	SET @Err = @@Error


	RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: InsertOracleLink Succeeded'
Else PRINT 'Procedure Creation: InsertOracleLink Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('GetOracleLinkByID') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
	BEGIN
		DROP PROCEDURE GetOracleLinkByID;
		PRINT 'Dropped GetOracleLinkByID'
	END
GO

/* ------------------------------------------------------------
   PROCEDURE:    GetOracleLinkByID
   
   Description:  Selects record(s) from table 'OracleLink'
   
   AUTHOR:       Rheem Manufacturing, Brian White - 8/23/2011 11:38:03 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.GetOracleLinkByID
(
	@OracleLinkID uniqueidentifier

)
As
BEGIN
	SET NOCOUNT ON
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
	
	DECLARE @Err Int

	Select 	[OracleLinkID], [OracleModuleID], [URL], [URLText], [AltText], [Active], [AlertText], [LinkOrder]
	FROM [OracleLink]
	WHERE [OracleLinkID] = @OracleLinkID

	Set @Err = @@Error

	RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: GetOracleLinkByID Succeeded'
Else PRINT 'Procedure Creation: GetOracleLinkByID Error on Creation'
GO





If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('SearchOracleLinkByString') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
	BEGIN
		DROP PROCEDURE SearchOracleLinkByString;
		PRINT 'Dropped SearchOracleLinkByString'
	END
GO

/* ------------------------------------------------------------
   PROCEDURE:    SearchOracleLinkByString
   
   Description:  Selects a record from table 'OracleLink'
   				 And puts values into parameters
   
   AUTHOR:       Rheem Manufacturing, Brian White - 8/23/2011 11:38:03 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.SearchOracleLinkByString
(
	@searchParam varchar(4000)
)
As
BEGIN
	SET NOCOUNT ON
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
	
	DECLARE @Err Int
	DECLARE @strSql varchar(4000)
	
	SET @strSql = '	Select 	[OracleLinkID], [OracleModuleID], [URL], [URLText], [AltText], [Active], [AlertText], [LinkOrder]
	FROM [OracleLink]
	WHERE ' +  @searchParam

	EXEC(@strSql)
	
	--//We should NOT be using exec above.
	--//If params are NOT known, then be sure to clean sql
	--//If params are known, format like example below
	
	--IF @prodname IS NOT NULL
	--SELECT @sql = @sql + ' ProductName LIKE @prodname'
	--EXEC sp_executesql @sql, N'@prodname varchar(400)',@prodname
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: SearchOracleLinkByString Succeeded'
Else PRINT 'Procedure Creation: SearchOracleLinkByString Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('UpdateOracleLink') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
	BEGIN
		DROP PROCEDURE UpdateOracleLink;
		PRINT 'Dropped UpdateOracleLink'
	END
GO

/* ------------------------------------------------------------
   PROCEDURE:    UpdateOracleLink
   
   Description:  Updates a record In table 'OracleLink'
   
   AUTHOR:       Rheem Manufacturing, Brian White - 8/23/2011 11:38:03 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.UpdateOracleLink
(
	@OracleLinkID uniqueidentifier, 
	@OracleModuleID uniqueidentifier, 
	@URL varchar(150), 
	@URLText varchar(150), 
	@AltText varchar(500), 
	@Active bit, 
	@AlertText varchar(500), 
	@LinkOrder int

)
As
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
	DECLARE @Err Int

	UPDATE [OracleLink]
	SET
	[OracleLinkID] = @OracleLinkID, 
	[OracleModuleID] = @OracleModuleID, 
	[URL] = @URL, 
	[URLText] = @URLText, 
	[AltText] = @AltText, 
	[Active] = @Active, 
	[AlertText] = @AlertText, 
	[LinkOrder] = @LinkOrder

	WHERE [OracleLinkID] = @OracleLinkID

	Set @Err = @@Error

	RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: UpdateOracleLink Succeeded'
Else PRINT 'Procedure Creation: UpdateOracleLink Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('DeleteOracleLink') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
	BEGIN
		DROP PROCEDURE DeleteOracleLink;
		PRINT 'Dropped DeleteOracleLink'
	END
GO

/* ------------------------------------------------------------
   PROCEDURE:    DeleteOracleLink
   
   Description:  Deletes a record from table 'OracleLink'
   
   AUTHOR:       Rheem Manufacturing, Brian White - 8/23/2011 11:38:03 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.DeleteOracleLink
(
	@OracleLinkID uniqueidentifier

)
As
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
	DECLARE @Err Int

	DELETE FROM [OracleLink] 
	WHERE [OracleLinkID] = @OracleLinkID
		

	Set @Err = @@Error

	RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: DeleteOracleLink Succeeded'
Else PRINT 'Procedure Creation: DeleteOracleLink Error on Creation'
GO