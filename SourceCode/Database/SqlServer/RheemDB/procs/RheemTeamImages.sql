/*
'===============================================================================
'  Generated by GenerateDataAndObjectLayer Version 1.0.0.0
'
'  Generated by user: bill on 11/1/2011 11:12:07 AM
'===============================================================================

*/
USE [rheemdb]

/* ------------------------------------------------------------
   Get rid of obsolete InsertRheemTeamImages
   Get rid of obsolete UpdateRheemTeamImages
   ------------------------------------------------------------ */
If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('InsertRheemTeamImages') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE InsertRheemTeamImages;
        PRINT 'Dropped InsertRheemTeamImages'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('UpdateRheemTeamImages') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE UpdateRheemTeamImages;
        PRINT 'Dropped UpdateRheemTeamImages'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('GetRheemTeamImagesByID') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE GetRheemTeamImagesByID;
        PRINT 'Dropped GetRheemTeamImagesByID'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    GetRheemTeamImagesByID

   Description:  Selects record(s) from table 'RheemTeamImages'

   AUTHOR: bill on 11/1/2011 11:12:07 AM

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.GetRheemTeamImagesByID
(
    @PictureID uniqueidentifier

)

AS
BEGIN
    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    DECLARE @Err Int

    Select [PictureID],[DealerID],[ImageTitle],[MimeType],[Picture],[Caption]
    FROM [RheemTeamImages]
    WHERE [PictureID] = @PictureID

    SET @Err = @@Error


    RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: GetRheemTeamImagesByID Succeeded'
Else PRINT 'Procedure Creation: GetRheemTeamImagesByID Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('SearchRheemTeamImagesByString') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE SearchRheemTeamImagesByString;
        PRINT 'Dropped SearchRheemTeamImagesByString'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    SearchRheemTeamImagesByString

   Description:  Selects a record from table 'RheemTeamImages'
                 And puts values into parameters

   AUTHOR: bill on 11/1/2011 11:12:07 AM

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.SearchRheemTeamImagesByString
(
    @searchParam varchar(4000)
)

AS
BEGIN
    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    DECLARE @Err Int
    DECLARE @strSql varchar(4000)

    SET @strSql = ' Select [PictureID],[DealerID],[ImageTitle],[MimeType],[Picture],[Caption]
    FROM [RheemTeamImages]
    WHERE ' +  @searchParam

    EXEC(@strSql)

    --//We should NOT be using exec above.
    --//If params are NOT known, then be sure to clean sql
    --//If params are known, format like example below

    --IF @prodname IS NOT NULL
    --SELECT @sql = @sql + ' ProductName LIKE @prodname'
    --EXEC sp_executesql @sql, N'@prodname varchar(400)',@prodname

    SET @Err = @@Error


    RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: SearchRheemTeamImagesByString Succeeded'
Else PRINT 'Procedure Creation: SearchRheemTeamImagesByString Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('RheemTeamImages_SearchByParam') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE RheemTeamImages_SearchByParam;
        PRINT 'Dropped RheemTeamImages_SearchByParam'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    RheemTeamImages_SearchByParam

   Description:  Search by columns in table 'RheemTeamImages'
                 This is much more secure than SearchByString!!!

   AUTHOR: bill on 11/1/2011 11:12:07 AM

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.RheemTeamImages_SearchByParam
(
    @DealerID uniqueidentifier,
    @ImageTitle char(15),
    @MimeType varchar(50),
    @Picture image,
    @Caption varchar(50)
)

AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
    DECLARE @Err Int


    SET @Err = @@Error


    RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: RheemTeamImages_Save Succeeded'
Else PRINT 'Procedure Creation: RheemTeamImages_Save Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('DeleteRheemTeamImages') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE DeleteRheemTeamImages;
        PRINT 'Dropped DeleteRheemTeamImages'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    DeleteRheemTeamImages

   Description:  Deletes a record from table 'RheemTeamImages'

   AUTHOR: bill on 11/1/2011 11:12:07 AM

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.DeleteRheemTeamImages
(
    @PictureID uniqueidentifier

)
AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
    DECLARE @Err Int


    DELETE FROM [RheemTeamImages]
    WHERE [PictureID] = @PictureID


    SET @Err = @@Error


    RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: DeleteRheemTeamImages Succeeded'
Else PRINT 'Procedure Creation: DeleteRheemTeamImages Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('RheemTeamImages_Save') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE RheemTeamImages_Save;
        PRINT 'Dropped RheemTeamImages_Save'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    RheemTeamImages_Save

   Description:  Updates or Deletes a record In table 'RheemTeamImages'

   AUTHOR: bill on 11/1/2011 11:12:07 AM

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.RheemTeamImages_Save
(
    @PictureID uniqueidentifier output,
    @DealerID uniqueidentifier,
    @ImageTitle char(15),
    @MimeType varchar(50),
    @Picture image,
    @Caption varchar(50)
)

AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
    DECLARE @Err Int

    IF @PictureID = '00000000-0000-0000-0000-000000000000' SET @PictureID = NULL
    IF @PictureID IS NULL
        BEGIN
            SET @PictureID = NewID()

            INSERT
            INTO [RheemTeamImages]
            (
                [PictureID],
                [DealerID],
                [ImageTitle],
                [MimeType],
                [Picture],
                [Caption]
            )
            VALUES
            (
                @PictureID,
                @DealerID,
                @ImageTitle,
                @MimeType,
                @Picture,
                @Caption
            )
        END
    ELSE
        BEGIN
            UPDATE [RheemTeamImages]
            SET
            [DealerID] = @DealerID,
            [ImageTitle] = @ImageTitle,
            [MimeType] = @MimeType,
            [Picture] = @Picture,
            [Caption] = @Caption
            WHERE [PictureID] = @PictureID
        END

    SET @Err = @@Error


    RETURN @Err
End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: RheemTeamImages_Save Succeeded'
Else PRINT 'Procedure Creation: RheemTeamImages_Save Error on Creation'
GO




