/*
'===============================================================================
' Generated by GenerateDataAndObjectLayer Version 1.0.0.0
'
' <auto-generated>
'     This code was generated by a tool.
'
'     Changes to this file may cause incorrect behavior and will be lost if
'     the code is regenerated. 
' </auto-generated>
'===============================================================================

*/
USE [RheemDB]

/* ------------------------------------------------------------
   Get rid of obsolete InsertEC_Forecast
   Get rid of obsolete UpdateEC_Forecast
   Get rid of obsolete DeleteEC_Forecast
   Get rid of obsolete SearchEC_ForecastByString
   Get rid of obsolete GetEC_ForecastByID
   ------------------------------------------------------------ */
If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('InsertEC_Forecast') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE InsertEC_Forecast;
        PRINT 'Dropped InsertEC_Forecast'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('UpdateEC_Forecast') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE UpdateEC_Forecast;
        PRINT 'Dropped UpdateEC_Forecast'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('DeleteEC_Forecast') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE DeleteEC_Forecast;
        PRINT 'Dropped DeleteEC_Forecast'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('SearchEC_ForecastByString') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE SearchEC_ForecastByString;
        PRINT 'Dropped SearchEC_ForecastByString'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('GetEC_ForecastByID') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE GetEC_ForecastByID;
        PRINT 'Dropped GetEC_ForecastByID'
    END
GO

If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('spGen__EC_Forecast_GetByID') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE spGen__EC_Forecast_GetByID;
        PRINT 'Dropped spGen__EC_Forecast_GetByID'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    spGen__EC_Forecast_GetByID

   Description:  Selects record(s) from table 'EC_Forecast'

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.spGen__EC_Forecast_GetByID
(
    @ForecastID uniqueidentifier

)

AS
BEGIN
    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    DECLARE @Err Int

    Select [ForecastID],[OrganizationID],[GDPYear],[PreviousYear1Sales],[PreviousYear2Sales],[PriceIncrease],[GDPFunding],[TCFunding],[RRHeatingUnits],[RRHeatingDollars],[RRACUnits],[RRACDollars],[RRCommercialUnits],[RRCommercialDollars],[VLHeatingUnits],[VLHeatingDollars],[VLACUnits],[VLACDollars],[Description],[ResidentialLoss],[TargetNew],[GrowExisting],[NewCommercial],[MigrationLoss],[RNCGrowth],[Misc1Desc],[Misc2Desc],[Misc3Desc],[Misc1Units],[Misc2Units],[Misc3Units],[Misc1Dollars],[Misc2Dollars],[Misc3Dollars],[VLPlannedIncrease],[Q1Units],[Q1Dollars],[Q2Units],[Q2Dollars],[Q3Units],[Q3Dollars],[Q4Units],[Q4Dollars],[Y2Q1Percent],[Y2Q2Percent],[Y2Q3Percent],[Y2Q4Percent],[Y2TotalUnits],[Y2TotalDollars],[NumberOfNewDealers],[NumberOfNewBuilders],[KeyObjectives],[DSMDevelopment],[Y1DecPurchases],[Y2JanPurchases],[Y2FebPurchases],[Y2MarPurchases],[Y2AprPurchases],[Y2MayPurchases],[Y2JunPurchases],[Y2JulPurchases],[Y2AugPurchases],[Y2SepPurchases],[Y2OctPurchases],[Y2NovPurchases],[StartingDepositAllocated],[Y1DecAllocated],[Y2JanAllocated],[Y2FebAllocated],[Y2MarAllocated],[Y2AprAllocated],[Y2MayAllocated],[Y2JunAllocated],[Y2JulAllocated],[Y2AugAllocated],[Y2SepAllocated],[Y2OctAllocated],[Y2NovAllocated],[GDPBudgetStatus],[TCBudgetStatus],[PartsDollars],[PartsIncreaseDollars],[IgnoreSalesThresholdForTC],[Misc4Desc],[Misc4Units],[Misc4Dollars],[Misc5Units],[Misc6Units],[Misc5Desc],[Misc6Desc],[HighEffPrevYear2],[HighEffPrevYear1],[HighEffCurrentYear],[IndustryACSharePrevYear3],[IndustryACSharePrevYear2],[IndustryACSharePrevYear1],[IndustryACShareCurrentYear],[IndustryGasSharePrevYear3],[IndustryGasSharePrevYear2],[IndustryGasSharePrevYear1],[IndustryGasShareCurrentYear],[MarketACSharePrevYear3],[MarketACSharePrevYear2],[MarketACSharePrevYear1],[MarketACShareCurrentYear],[MarketGasSharePrevYear3],[MarketGasSharePrevYear2],[MarketGasSharePrevYear1],[MarketGasShareCurrentYear],[MarketCommSharePrevYear3],[MarketCommSharePrevYear2],[MarketCommSharePrevYear1],[MarketCommShareCurrentYear],[MarketTotalSharePrevYear3],[MarketTotalSharePrevYear2],[MarketTotalSharePrevYear1],[MarketTotalShareCurrentYear],[R22Purchases],[RetailPurchases],[AuditFrequency],[GDPEarningPercentage],[TCEarningPercentage],[TotalEstCoopFunding]
    FROM [EC_Forecast]
    WHERE [ForecastID] = @ForecastID

End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: spGen__EC_Forecast_GetByID Succeeded'
Else PRINT 'Procedure Creation: spGen__EC_Forecast_GetByID Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('spGen__EC_Forecast_SearchByString') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE spGen__EC_Forecast_SearchByString;
        PRINT 'Dropped spGen__EC_Forecast_SearchByString'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    spGen__EC_Forecast_SearchByString

   Description:  Selects a record from table 'EC_Forecast'
                 And puts values into parameters

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.spGen__EC_Forecast_SearchByString
(
    @searchParam varchar(4000)
)

AS
BEGIN
    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    DECLARE @Err Int
    DECLARE @strSql varchar(4000)

    SET @strSql = ' Select [ForecastID],[OrganizationID],[GDPYear],[PreviousYear1Sales],[PreviousYear2Sales],[PriceIncrease],[GDPFunding],[TCFunding],[RRHeatingUnits],[RRHeatingDollars],[RRACUnits],[RRACDollars],[RRCommercialUnits],[RRCommercialDollars],[VLHeatingUnits],[VLHeatingDollars],[VLACUnits],[VLACDollars],[Description],[ResidentialLoss],[TargetNew],[GrowExisting],[NewCommercial],[MigrationLoss],[RNCGrowth],[Misc1Desc],[Misc2Desc],[Misc3Desc],[Misc1Units],[Misc2Units],[Misc3Units],[Misc1Dollars],[Misc2Dollars],[Misc3Dollars],[VLPlannedIncrease],[Q1Units],[Q1Dollars],[Q2Units],[Q2Dollars],[Q3Units],[Q3Dollars],[Q4Units],[Q4Dollars],[Y2Q1Percent],[Y2Q2Percent],[Y2Q3Percent],[Y2Q4Percent],[Y2TotalUnits],[Y2TotalDollars],[NumberOfNewDealers],[NumberOfNewBuilders],[KeyObjectives],[DSMDevelopment],[Y1DecPurchases],[Y2JanPurchases],[Y2FebPurchases],[Y2MarPurchases],[Y2AprPurchases],[Y2MayPurchases],[Y2JunPurchases],[Y2JulPurchases],[Y2AugPurchases],[Y2SepPurchases],[Y2OctPurchases],[Y2NovPurchases],[StartingDepositAllocated],[Y1DecAllocated],[Y2JanAllocated],[Y2FebAllocated],[Y2MarAllocated],[Y2AprAllocated],[Y2MayAllocated],[Y2JunAllocated],[Y2JulAllocated],[Y2AugAllocated],[Y2SepAllocated],[Y2OctAllocated],[Y2NovAllocated],[GDPBudgetStatus],[TCBudgetStatus],[PartsDollars],[PartsIncreaseDollars],[IgnoreSalesThresholdForTC],[Misc4Desc],[Misc4Units],[Misc4Dollars],[Misc5Units],[Misc6Units],[Misc5Desc],[Misc6Desc],[HighEffPrevYear2],[HighEffPrevYear1],[HighEffCurrentYear],[IndustryACSharePrevYear3],[IndustryACSharePrevYear2],[IndustryACSharePrevYear1],[IndustryACShareCurrentYear],[IndustryGasSharePrevYear3],[IndustryGasSharePrevYear2],[IndustryGasSharePrevYear1],[IndustryGasShareCurrentYear],[MarketACSharePrevYear3],[MarketACSharePrevYear2],[MarketACSharePrevYear1],[MarketACShareCurrentYear],[MarketGasSharePrevYear3],[MarketGasSharePrevYear2],[MarketGasSharePrevYear1],[MarketGasShareCurrentYear],[MarketCommSharePrevYear3],[MarketCommSharePrevYear2],[MarketCommSharePrevYear1],[MarketCommShareCurrentYear],[MarketTotalSharePrevYear3],[MarketTotalSharePrevYear2],[MarketTotalSharePrevYear1],[MarketTotalShareCurrentYear],[R22Purchases],[RetailPurchases],[AuditFrequency],[GDPEarningPercentage],[TCEarningPercentage],[TotalEstCoopFunding]
    FROM [EC_Forecast]
    WHERE ' +  @searchParam

    EXEC(@strSql)

    --//We should NOT be using exec above.
    --//If params are NOT known, then be sure to clean sql
    --//If params are known, format like example below

    --IF @prodname IS NOT NULL
    --SELECT @sql = @sql + ' ProductName LIKE @prodname'
    --EXEC sp_executesql @sql, N'@prodname varchar(400)',@prodname

End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: spGen__EC_Forecast_SearchByString Succeeded'
Else PRINT 'Procedure Creation: spGen__EC_Forecast_SearchByString Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('spGen__EC_Forecast_Delete') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE spGen__EC_Forecast_Delete;
        PRINT 'Dropped spGen__EC_Forecast_Delete'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    spGen__EC_Forecast_Delete

   Description:  Deletes a record from table 'EC_Forecast'

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.spGen__EC_Forecast_Delete
(
    @ForecastID uniqueidentifier

)
AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN
    DECLARE @Err Int


    DELETE FROM [EC_Forecast]
    WHERE [ForecastID] = @ForecastID


End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: spGen__EC_Forecast_Delete Succeeded'
Else PRINT 'Procedure Creation: spGen__EC_Forecast_Delete Error on Creation'
GO




If EXISTS (Select * FROM SYSOBJECTS WHERE ID = OBJECT_ID('spGen__EC_Forecast_Save') AND OBJECTPROPERTY(ID, 'IsProcedure') = 1)
    BEGIN
        DROP PROCEDURE spGen__EC_Forecast_Save;
        PRINT 'Dropped spGen__EC_Forecast_Save'
    END
GO

/* ------------------------------------------------------------
   PROCEDURE:    spGen__EC_Forecast_Save

   Description:  Updates or Deletes a record In table 'EC_Forecast'

   Generated by GenerateDataAndObjectLayer Version 1.0.0.0
   ------------------------------------------------------------ */

CREATE PROCEDURE dbo.spGen__EC_Forecast_Save
(
    @ErrText varchar(4000) output,
    @ForecastID uniqueidentifier output,
    @OrganizationID uniqueidentifier,
    @GDPYear int,
    @PreviousYear1Sales float,
    @PreviousYear2Sales float,
    @PriceIncrease float,
    @GDPFunding float,
    @TCFunding float,
    @RRHeatingUnits int,
    @RRHeatingDollars float,
    @RRACUnits int,
    @RRACDollars float,
    @RRCommercialUnits int,
    @RRCommercialDollars float,
    @VLHeatingUnits int,
    @VLHeatingDollars float,
    @VLACUnits int,
    @VLACDollars float,
    @Description text,
    @ResidentialLoss int,
    @TargetNew int,
    @GrowExisting int,
    @NewCommercial int,
    @MigrationLoss int,
    @RNCGrowth int,
    @Misc1Desc varchar(50),
    @Misc2Desc varchar(50),
    @Misc3Desc varchar(50),
    @Misc1Units int,
    @Misc2Units int,
    @Misc3Units int,
    @Misc1Dollars float,
    @Misc2Dollars float,
    @Misc3Dollars float,
    @VLPlannedIncrease int,
    @Q1Units int,
    @Q1Dollars float,
    @Q2Units int,
    @Q2Dollars float,
    @Q3Units int,
    @Q3Dollars float,
    @Q4Units int,
    @Q4Dollars float,
    @Y2Q1Percent int,
    @Y2Q2Percent int,
    @Y2Q3Percent int,
    @Y2Q4Percent int,
    @Y2TotalUnits int,
    @Y2TotalDollars float,
    @NumberOfNewDealers int,
    @NumberOfNewBuilders int,
    @KeyObjectives text,
    @DSMDevelopment text,
    @Y1DecPurchases float,
    @Y2JanPurchases float,
    @Y2FebPurchases float,
    @Y2MarPurchases float,
    @Y2AprPurchases float,
    @Y2MayPurchases float,
    @Y2JunPurchases float,
    @Y2JulPurchases float,
    @Y2AugPurchases float,
    @Y2SepPurchases float,
    @Y2OctPurchases float,
    @Y2NovPurchases float,
    @StartingDepositAllocated bit,
    @Y1DecAllocated bit,
    @Y2JanAllocated bit,
    @Y2FebAllocated bit,
    @Y2MarAllocated bit,
    @Y2AprAllocated bit,
    @Y2MayAllocated bit,
    @Y2JunAllocated bit,
    @Y2JulAllocated bit,
    @Y2AugAllocated bit,
    @Y2SepAllocated bit,
    @Y2OctAllocated bit,
    @Y2NovAllocated bit,
    @GDPBudgetStatus varchar(50),
    @TCBudgetStatus varchar(50),
    @PartsDollars float,
    @PartsIncreaseDollars float,
    @IgnoreSalesThresholdForTC bit,
    @Misc4Desc varchar(50),
    @Misc4Units int,
    @Misc4Dollars float,
    @Misc5Units int,
    @Misc6Units int,
    @Misc5Desc varchar(50),
    @Misc6Desc varchar(50),
    @HighEffPrevYear2 float,
    @HighEffPrevYear1 float,
    @HighEffCurrentYear float,
    @IndustryACSharePrevYear3 float,
    @IndustryACSharePrevYear2 float,
    @IndustryACSharePrevYear1 float,
    @IndustryACShareCurrentYear float,
    @IndustryGasSharePrevYear3 float,
    @IndustryGasSharePrevYear2 float,
    @IndustryGasSharePrevYear1 float,
    @IndustryGasShareCurrentYear float,
    @MarketACSharePrevYear3 float,
    @MarketACSharePrevYear2 float,
    @MarketACSharePrevYear1 float,
    @MarketACShareCurrentYear float,
    @MarketGasSharePrevYear3 float,
    @MarketGasSharePrevYear2 float,
    @MarketGasSharePrevYear1 float,
    @MarketGasShareCurrentYear float,
    @MarketCommSharePrevYear3 float,
    @MarketCommSharePrevYear2 float,
    @MarketCommSharePrevYear1 float,
    @MarketCommShareCurrentYear float,
    @MarketTotalSharePrevYear3 float,
    @MarketTotalSharePrevYear2 float,
    @MarketTotalSharePrevYear1 float,
    @MarketTotalShareCurrentYear float,
    @R22Purchases float,
    @RetailPurchases float,
    @AuditFrequency int,
    @GDPEarningPercentage decimal(4,3),
    @TCEarningPercentage decimal(4,3),
    @TotalEstCoopFunding decimal(18,3)
)

AS
SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN

    DECLARE @UniqueRowCount Int
    IF @ForecastID = '00000000-0000-0000-0000-000000000000' SET @ForecastID = NULL
    IF @ForecastID IS NULL
        BEGIN
            SET @UniqueRowCount = 0       -- No unique indexes exist for this table
            IF @UniqueRowCount > 0
                BEGIN
                    SET @ErrText = ''    -- No unique indexes exist for this table
                END
            ELSE
                BEGIN
                    SET @ForecastID = NewID()

                    INSERT
                    INTO [EC_Forecast]
                    (
                        [ForecastID],
                        [OrganizationID],
                        [GDPYear],
                        [PreviousYear1Sales],
                        [PreviousYear2Sales],
                        [PriceIncrease],
                        [GDPFunding],
                        [TCFunding],
                        [RRHeatingUnits],
                        [RRHeatingDollars],
                        [RRACUnits],
                        [RRACDollars],
                        [RRCommercialUnits],
                        [RRCommercialDollars],
                        [VLHeatingUnits],
                        [VLHeatingDollars],
                        [VLACUnits],
                        [VLACDollars],
                        [Description],
                        [ResidentialLoss],
                        [TargetNew],
                        [GrowExisting],
                        [NewCommercial],
                        [MigrationLoss],
                        [RNCGrowth],
                        [Misc1Desc],
                        [Misc2Desc],
                        [Misc3Desc],
                        [Misc1Units],
                        [Misc2Units],
                        [Misc3Units],
                        [Misc1Dollars],
                        [Misc2Dollars],
                        [Misc3Dollars],
                        [VLPlannedIncrease],
                        [Q1Units],
                        [Q1Dollars],
                        [Q2Units],
                        [Q2Dollars],
                        [Q3Units],
                        [Q3Dollars],
                        [Q4Units],
                        [Q4Dollars],
                        [Y2Q1Percent],
                        [Y2Q2Percent],
                        [Y2Q3Percent],
                        [Y2Q4Percent],
                        [Y2TotalUnits],
                        [Y2TotalDollars],
                        [NumberOfNewDealers],
                        [NumberOfNewBuilders],
                        [KeyObjectives],
                        [DSMDevelopment],
                        [Y1DecPurchases],
                        [Y2JanPurchases],
                        [Y2FebPurchases],
                        [Y2MarPurchases],
                        [Y2AprPurchases],
                        [Y2MayPurchases],
                        [Y2JunPurchases],
                        [Y2JulPurchases],
                        [Y2AugPurchases],
                        [Y2SepPurchases],
                        [Y2OctPurchases],
                        [Y2NovPurchases],
                        [StartingDepositAllocated],
                        [Y1DecAllocated],
                        [Y2JanAllocated],
                        [Y2FebAllocated],
                        [Y2MarAllocated],
                        [Y2AprAllocated],
                        [Y2MayAllocated],
                        [Y2JunAllocated],
                        [Y2JulAllocated],
                        [Y2AugAllocated],
                        [Y2SepAllocated],
                        [Y2OctAllocated],
                        [Y2NovAllocated],
                        [GDPBudgetStatus],
                        [TCBudgetStatus],
                        [PartsDollars],
                        [PartsIncreaseDollars],
                        [IgnoreSalesThresholdForTC],
                        [Misc4Desc],
                        [Misc4Units],
                        [Misc4Dollars],
                        [Misc5Units],
                        [Misc6Units],
                        [Misc5Desc],
                        [Misc6Desc],
                        [HighEffPrevYear2],
                        [HighEffPrevYear1],
                        [HighEffCurrentYear],
                        [IndustryACSharePrevYear3],
                        [IndustryACSharePrevYear2],
                        [IndustryACSharePrevYear1],
                        [IndustryACShareCurrentYear],
                        [IndustryGasSharePrevYear3],
                        [IndustryGasSharePrevYear2],
                        [IndustryGasSharePrevYear1],
                        [IndustryGasShareCurrentYear],
                        [MarketACSharePrevYear3],
                        [MarketACSharePrevYear2],
                        [MarketACSharePrevYear1],
                        [MarketACShareCurrentYear],
                        [MarketGasSharePrevYear3],
                        [MarketGasSharePrevYear2],
                        [MarketGasSharePrevYear1],
                        [MarketGasShareCurrentYear],
                        [MarketCommSharePrevYear3],
                        [MarketCommSharePrevYear2],
                        [MarketCommSharePrevYear1],
                        [MarketCommShareCurrentYear],
                        [MarketTotalSharePrevYear3],
                        [MarketTotalSharePrevYear2],
                        [MarketTotalSharePrevYear1],
                        [MarketTotalShareCurrentYear],
                        [R22Purchases],
                        [RetailPurchases],
                        [AuditFrequency],
                        [GDPEarningPercentage],
                        [TCEarningPercentage],
                        [TotalEstCoopFunding]
                    )
                    VALUES
                    (
                        @ForecastID,
                        @OrganizationID,
                        @GDPYear,
                        @PreviousYear1Sales,
                        @PreviousYear2Sales,
                        @PriceIncrease,
                        @GDPFunding,
                        @TCFunding,
                        @RRHeatingUnits,
                        @RRHeatingDollars,
                        @RRACUnits,
                        @RRACDollars,
                        @RRCommercialUnits,
                        @RRCommercialDollars,
                        @VLHeatingUnits,
                        @VLHeatingDollars,
                        @VLACUnits,
                        @VLACDollars,
                        @Description,
                        @ResidentialLoss,
                        @TargetNew,
                        @GrowExisting,
                        @NewCommercial,
                        @MigrationLoss,
                        @RNCGrowth,
                        @Misc1Desc,
                        @Misc2Desc,
                        @Misc3Desc,
                        @Misc1Units,
                        @Misc2Units,
                        @Misc3Units,
                        @Misc1Dollars,
                        @Misc2Dollars,
                        @Misc3Dollars,
                        @VLPlannedIncrease,
                        @Q1Units,
                        @Q1Dollars,
                        @Q2Units,
                        @Q2Dollars,
                        @Q3Units,
                        @Q3Dollars,
                        @Q4Units,
                        @Q4Dollars,
                        @Y2Q1Percent,
                        @Y2Q2Percent,
                        @Y2Q3Percent,
                        @Y2Q4Percent,
                        @Y2TotalUnits,
                        @Y2TotalDollars,
                        @NumberOfNewDealers,
                        @NumberOfNewBuilders,
                        @KeyObjectives,
                        @DSMDevelopment,
                        @Y1DecPurchases,
                        @Y2JanPurchases,
                        @Y2FebPurchases,
                        @Y2MarPurchases,
                        @Y2AprPurchases,
                        @Y2MayPurchases,
                        @Y2JunPurchases,
                        @Y2JulPurchases,
                        @Y2AugPurchases,
                        @Y2SepPurchases,
                        @Y2OctPurchases,
                        @Y2NovPurchases,
                        @StartingDepositAllocated,
                        @Y1DecAllocated,
                        @Y2JanAllocated,
                        @Y2FebAllocated,
                        @Y2MarAllocated,
                        @Y2AprAllocated,
                        @Y2MayAllocated,
                        @Y2JunAllocated,
                        @Y2JulAllocated,
                        @Y2AugAllocated,
                        @Y2SepAllocated,
                        @Y2OctAllocated,
                        @Y2NovAllocated,
                        @GDPBudgetStatus,
                        @TCBudgetStatus,
                        @PartsDollars,
                        @PartsIncreaseDollars,
                        @IgnoreSalesThresholdForTC,
                        @Misc4Desc,
                        @Misc4Units,
                        @Misc4Dollars,
                        @Misc5Units,
                        @Misc6Units,
                        @Misc5Desc,
                        @Misc6Desc,
                        @HighEffPrevYear2,
                        @HighEffPrevYear1,
                        @HighEffCurrentYear,
                        @IndustryACSharePrevYear3,
                        @IndustryACSharePrevYear2,
                        @IndustryACSharePrevYear1,
                        @IndustryACShareCurrentYear,
                        @IndustryGasSharePrevYear3,
                        @IndustryGasSharePrevYear2,
                        @IndustryGasSharePrevYear1,
                        @IndustryGasShareCurrentYear,
                        @MarketACSharePrevYear3,
                        @MarketACSharePrevYear2,
                        @MarketACSharePrevYear1,
                        @MarketACShareCurrentYear,
                        @MarketGasSharePrevYear3,
                        @MarketGasSharePrevYear2,
                        @MarketGasSharePrevYear1,
                        @MarketGasShareCurrentYear,
                        @MarketCommSharePrevYear3,
                        @MarketCommSharePrevYear2,
                        @MarketCommSharePrevYear1,
                        @MarketCommShareCurrentYear,
                        @MarketTotalSharePrevYear3,
                        @MarketTotalSharePrevYear2,
                        @MarketTotalSharePrevYear1,
                        @MarketTotalShareCurrentYear,
                        @R22Purchases,
                        @RetailPurchases,
                        @AuditFrequency,
                        @GDPEarningPercentage,
                        @TCEarningPercentage,
                        @TotalEstCoopFunding
                    )
                END
        END
    ELSE
        BEGIN
            SET @UniqueRowCount = 0       -- No unique indexes exist for this table
            IF @UniqueRowCount > 0
                BEGIN
                    SET @ErrText = ''    -- No unique indexes exist for this table
                END
            ELSE
                BEGIN
                    UPDATE [EC_Forecast]
                    SET
                    [OrganizationID] = @OrganizationID,
                    [GDPYear] = @GDPYear,
                    [PreviousYear1Sales] = @PreviousYear1Sales,
                    [PreviousYear2Sales] = @PreviousYear2Sales,
                    [PriceIncrease] = @PriceIncrease,
                    [GDPFunding] = @GDPFunding,
                    [TCFunding] = @TCFunding,
                    [RRHeatingUnits] = @RRHeatingUnits,
                    [RRHeatingDollars] = @RRHeatingDollars,
                    [RRACUnits] = @RRACUnits,
                    [RRACDollars] = @RRACDollars,
                    [RRCommercialUnits] = @RRCommercialUnits,
                    [RRCommercialDollars] = @RRCommercialDollars,
                    [VLHeatingUnits] = @VLHeatingUnits,
                    [VLHeatingDollars] = @VLHeatingDollars,
                    [VLACUnits] = @VLACUnits,
                    [VLACDollars] = @VLACDollars,
                    [Description] = @Description,
                    [ResidentialLoss] = @ResidentialLoss,
                    [TargetNew] = @TargetNew,
                    [GrowExisting] = @GrowExisting,
                    [NewCommercial] = @NewCommercial,
                    [MigrationLoss] = @MigrationLoss,
                    [RNCGrowth] = @RNCGrowth,
                    [Misc1Desc] = @Misc1Desc,
                    [Misc2Desc] = @Misc2Desc,
                    [Misc3Desc] = @Misc3Desc,
                    [Misc1Units] = @Misc1Units,
                    [Misc2Units] = @Misc2Units,
                    [Misc3Units] = @Misc3Units,
                    [Misc1Dollars] = @Misc1Dollars,
                    [Misc2Dollars] = @Misc2Dollars,
                    [Misc3Dollars] = @Misc3Dollars,
                    [VLPlannedIncrease] = @VLPlannedIncrease,
                    [Q1Units] = @Q1Units,
                    [Q1Dollars] = @Q1Dollars,
                    [Q2Units] = @Q2Units,
                    [Q2Dollars] = @Q2Dollars,
                    [Q3Units] = @Q3Units,
                    [Q3Dollars] = @Q3Dollars,
                    [Q4Units] = @Q4Units,
                    [Q4Dollars] = @Q4Dollars,
                    [Y2Q1Percent] = @Y2Q1Percent,
                    [Y2Q2Percent] = @Y2Q2Percent,
                    [Y2Q3Percent] = @Y2Q3Percent,
                    [Y2Q4Percent] = @Y2Q4Percent,
                    [Y2TotalUnits] = @Y2TotalUnits,
                    [Y2TotalDollars] = @Y2TotalDollars,
                    [NumberOfNewDealers] = @NumberOfNewDealers,
                    [NumberOfNewBuilders] = @NumberOfNewBuilders,
                    [KeyObjectives] = @KeyObjectives,
                    [DSMDevelopment] = @DSMDevelopment,
                    [Y1DecPurchases] = @Y1DecPurchases,
                    [Y2JanPurchases] = @Y2JanPurchases,
                    [Y2FebPurchases] = @Y2FebPurchases,
                    [Y2MarPurchases] = @Y2MarPurchases,
                    [Y2AprPurchases] = @Y2AprPurchases,
                    [Y2MayPurchases] = @Y2MayPurchases,
                    [Y2JunPurchases] = @Y2JunPurchases,
                    [Y2JulPurchases] = @Y2JulPurchases,
                    [Y2AugPurchases] = @Y2AugPurchases,
                    [Y2SepPurchases] = @Y2SepPurchases,
                    [Y2OctPurchases] = @Y2OctPurchases,
                    [Y2NovPurchases] = @Y2NovPurchases,
                    [StartingDepositAllocated] = @StartingDepositAllocated,
                    [Y1DecAllocated] = @Y1DecAllocated,
                    [Y2JanAllocated] = @Y2JanAllocated,
                    [Y2FebAllocated] = @Y2FebAllocated,
                    [Y2MarAllocated] = @Y2MarAllocated,
                    [Y2AprAllocated] = @Y2AprAllocated,
                    [Y2MayAllocated] = @Y2MayAllocated,
                    [Y2JunAllocated] = @Y2JunAllocated,
                    [Y2JulAllocated] = @Y2JulAllocated,
                    [Y2AugAllocated] = @Y2AugAllocated,
                    [Y2SepAllocated] = @Y2SepAllocated,
                    [Y2OctAllocated] = @Y2OctAllocated,
                    [Y2NovAllocated] = @Y2NovAllocated,
                    [GDPBudgetStatus] = @GDPBudgetStatus,
                    [TCBudgetStatus] = @TCBudgetStatus,
                    [PartsDollars] = @PartsDollars,
                    [PartsIncreaseDollars] = @PartsIncreaseDollars,
                    [IgnoreSalesThresholdForTC] = @IgnoreSalesThresholdForTC,
                    [Misc4Desc] = @Misc4Desc,
                    [Misc4Units] = @Misc4Units,
                    [Misc4Dollars] = @Misc4Dollars,
                    [Misc5Units] = @Misc5Units,
                    [Misc6Units] = @Misc6Units,
                    [Misc5Desc] = @Misc5Desc,
                    [Misc6Desc] = @Misc6Desc,
                    [HighEffPrevYear2] = @HighEffPrevYear2,
                    [HighEffPrevYear1] = @HighEffPrevYear1,
                    [HighEffCurrentYear] = @HighEffCurrentYear,
                    [IndustryACSharePrevYear3] = @IndustryACSharePrevYear3,
                    [IndustryACSharePrevYear2] = @IndustryACSharePrevYear2,
                    [IndustryACSharePrevYear1] = @IndustryACSharePrevYear1,
                    [IndustryACShareCurrentYear] = @IndustryACShareCurrentYear,
                    [IndustryGasSharePrevYear3] = @IndustryGasSharePrevYear3,
                    [IndustryGasSharePrevYear2] = @IndustryGasSharePrevYear2,
                    [IndustryGasSharePrevYear1] = @IndustryGasSharePrevYear1,
                    [IndustryGasShareCurrentYear] = @IndustryGasShareCurrentYear,
                    [MarketACSharePrevYear3] = @MarketACSharePrevYear3,
                    [MarketACSharePrevYear2] = @MarketACSharePrevYear2,
                    [MarketACSharePrevYear1] = @MarketACSharePrevYear1,
                    [MarketACShareCurrentYear] = @MarketACShareCurrentYear,
                    [MarketGasSharePrevYear3] = @MarketGasSharePrevYear3,
                    [MarketGasSharePrevYear2] = @MarketGasSharePrevYear2,
                    [MarketGasSharePrevYear1] = @MarketGasSharePrevYear1,
                    [MarketGasShareCurrentYear] = @MarketGasShareCurrentYear,
                    [MarketCommSharePrevYear3] = @MarketCommSharePrevYear3,
                    [MarketCommSharePrevYear2] = @MarketCommSharePrevYear2,
                    [MarketCommSharePrevYear1] = @MarketCommSharePrevYear1,
                    [MarketCommShareCurrentYear] = @MarketCommShareCurrentYear,
                    [MarketTotalSharePrevYear3] = @MarketTotalSharePrevYear3,
                    [MarketTotalSharePrevYear2] = @MarketTotalSharePrevYear2,
                    [MarketTotalSharePrevYear1] = @MarketTotalSharePrevYear1,
                    [MarketTotalShareCurrentYear] = @MarketTotalShareCurrentYear,
                    [R22Purchases] = @R22Purchases,
                    [RetailPurchases] = @RetailPurchases,
                    [AuditFrequency] = @AuditFrequency,
                    [GDPEarningPercentage] = @GDPEarningPercentage,
                    [TCEarningPercentage] = @TCEarningPercentage,
                    [TotalEstCoopFunding] = @TotalEstCoopFunding
                    WHERE [ForecastID] = @ForecastID
                END
        END

End
GO

-- Display the status of Proc creation
If @@Error = 0 PRINT 'Procedure Creation: spGen__EC_Forecast_Save Succeeded'
Else PRINT 'Procedure Creation: spGen__EC_Forecast_Save Error on Creation'
GO




