USE [rheemusers]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchBusinessCardByStringForList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SearchBusinessCardByStringForList]
GO


/****** Object:  StoredProcedure [dbo].[SearchBusinessCardByStringForList]    Script Date: 08/17/2011 12:31:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/* ------------------------------------------------------------
   PROCEDURE:    SearchBusinessCardByStringForList
   
   Description:  Selects a record from table 'BusinessCard'
   				 And puts values into parameters
   
   AUTHOR:       Rheem Manufacturing, Brian White - 7/13/2011 10:17:47 AM
   
   Generated by MyGeneration Version 1.3.0.9
   ------------------------------------------------------------ */

CREATE PROCEDURE [dbo].[SearchBusinessCardByStringForList]
(
	@searchParam varchar(4000)
)
As
BEGIN
	SET NOCOUNT ON
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
	
	DECLARE @Err Int
	DECLARE @strSql varchar(5000)
	
	SET @strSql = '	SELECT     dbo.BusinessCard.BusinessCardID, dbo.BusinessCard.EmployeeLine1, dbo.BusinessCard.EmployeeLine2, dbo.BusinessCard.EmployeeLine3, 
	dbo.BusinessCard.EmployeeLine4, dbo.BusinessCard.LocationLine1, dbo.BusinessCard.LocationLine2, dbo.BusinessCard.LocationLine3, 
	dbo.BusinessCard.LocationLine4, dbo.BusinessCard.LocationLine5, dbo.BusinessCard.LocationLine6, dbo.BusinessCard.LocationLine7, 
	dbo.BusinessCard.Shipping1, dbo.BusinessCard.Shipping2, dbo.BusinessCard.Shipping3, dbo.BusinessCard.Shipping4, dbo.BusinessCard.Shipping5, 
	dbo.BusinessCard.BillToName, dbo.BusinessCard.AccountCode, dbo.BusinessCard.Quantity, dbo.BusinessCard.EmailProof, dbo.BusinessCard.DateAdded, 
	dbo.BusinessCard.DateLastUpdated, dbo.BusinessCard.DateShipped, dbo.BusinessCard.Status, dbo.BusinessCard.OrderedByPersonID, rheemdb.dbo.Brand.BrandName, 
	dbo.Person.FirstName, dbo.Person.LastName, dbo.Person.EmailAddress
	FROM         dbo.BusinessCard LEFT OUTER JOIN
    rheemdb.dbo.Brand ON dbo.BusinessCard.BrandID = rheemdb.dbo.Brand.BrandID LEFT OUTER JOIN
    dbo.Person ON dbo.BusinessCard.OrderedByPersonID = dbo.Person.PersonID
	WHERE ' +  @searchParam

	EXEC(@strSql)
	
	--//We should NOT be using exec above.
	--//If params are NOT known, then be sure to clean sql
	--//If params are known, format like example below
	
	--IF @prodname IS NOT NULL
	--SELECT @sql = @sql + ' ProductName LIKE @prodname'
	--EXEC sp_executesql @sql, N'@prodname varchar(400)',@prodname
End
